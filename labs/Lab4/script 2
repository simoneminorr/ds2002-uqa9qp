# WRITE A SCRIPT (2 of 2)
# Like the bash script you wrote above, now write a simple Python script that performs a similar task. Your script should:
# - Fetch and save a file from the internet using urllib, requests or some other simple method. A simple gif would be a good file to work with, but your code should pull the file, not a human manually saving it.
# - Upload the file to a bucket in S3.
# - Presign the file with an expiration time. Documentation for that method is here
# - Output the presigned URL.
# - Test your script and be sure it works without error.
# - BONUS: If you'd like to learn a new skill, try using the argparse library to customize command-line arguments with a Python script.

import boto3
from botocore.exceptions import ClientError
import os
import sys
import requests

def upload_file(GIF_URL, BUCKET, object_name=None):
        response = requests.get(GIF_URL, stream=True)

def download_file(GIF_URL, BUCKET, EXPIRES):
        path = os.path.join(os.getcwd(), "downloaded.gif")
        response = requests.get(GIF_URL, stream=True)
        response.raise_for_status()
        with open(path, 'wb') as file:
                for chunk in response.iter_content(chunk_size=8192):
                        file.write(chunk)

        s3_client = boto3.client('s3', region_name="us-east-1")
        resp = s3_client.put_object(
                ACL = 'public-read',
                Body = path,
                Bucket = BUCKET,
                Key = path
        )

        response = s3_client.generate_presigned_url(
                'get_object',
                Params={'Bucket': BUCKET, 'Key': path},
                ExpiresIn= EXPIRES
        )

        print(response)

if __name__=="__main__":
        GIF_URL= sys.argv[1]
        BUCKET= sys.argv[2]
        EXPIRES= sys.argv[3]
        download_file(GIF_URL, BUCKET, EXPIRES)

Final Input: python3 lab4.script2.py https://s.yimg.com/ny/api/res/1.2/nITV.ukee6aggZzc0jasiQ--/YXBwaWQ9aGlnaGxhbmRlcjt3PTY0MDtoPTY0MA--/https://s.yimg.com/os/creatr-uploaded-images/2023-06/dfe6ff10-19ca-11ee-8d5b-8f954b8ec342

